- name: extract luajit2 source packages
  unarchive: 
    src: 'luajit2-{{pl_luajit2_version}}.tar.gz'
    dest: '{{pl_deploy_home}}'

- name: make luajit2
  make:
    chdir: '{{pl_deploy_home}}/luajit2-{{pl_luajit2_version}}'
    target: install
 
- name: export lua config files
  lineinfile: 
    dest: /etc/profile
    insertbefore: 'enset -f pathmunge' 
    line: '{{item}}' 
    state: present 
    backup: yes    
  with_items:
    - export LUAJIT_LIB=/usr/local/lib
    - export LUAJIT_INC=/usr/local/include/luajit-2.1
    
- name: ldconfig luajit
  copy: 
   src: luajit.conf
   dest: /etc/ld.so.conf.d/luajit.conf

- name: source ldconfig luajit 
  shell: /sbin/ldconfig